{% extends "template.html" %}

{% load filters %}
{% load wrapwith %}

{% block head %}
  {% include "popup_image.html" %}
{% endblock %}

{% block ptitle %}Task {{ task.id }} : STDWeb{% endblock %}

{% block title %}{{ task.original_name }}{% endblock %}

{% block content %}

  {% if not task %}
    <p>Task not found</p>
  {% else %}
    <p>
      Task {{ task.id }} created by {{ task.user|user }} on {{ task.created|timestamp }}
    </p>

    {% if 'image.fits' in files %}
      <div class="card" style="width: 18rem;">
        <div class="card-header"><a href="{% url 'task_download' task.id 'image.fits' %}">image.fits</a></div>
        <img src="{% url 'task_preview' task.id 'image.fits' %}?width=256" class="card-img-top" onclick="popupImage(event, '{% url 'task_preview' task.id 'image.fits' %}', 'image.fits', true)"/>
      </div>
    {% endif %}

  {% endif %}

  <!-- Management -->
  {% wrapwith "wrapper_management_commands.html" %}
  <form action="" method="POST">
    {% csrf_token %}
    <button type="submit" name="action" value="deletetask" class="btn btn-danger">Delete task</button>
  </form>
  {% endwrapwith %}

{% endblock %}
